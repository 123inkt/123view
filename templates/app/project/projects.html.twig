{% extends 'app/app.base.html.twig' %}

{%- macro projectColumns(projectsModel, repositories) -%}
    {%- if repositories|length > 0 -%}
        {% set columnSize = (repositories|length / 3)|round(1, 'ceil') %}
        {% set batches    = repositories|batch(columnSize) %}

        <div class="grid-display mb-5">
            {%- for batch in batches -%}
                <div class="list-group">
                    {%- for repository in batch -%}
                        <a class="list-group-item list-group-item-action"
                           href="{{ path('DR\\Review\\Controller\\App\\Reviews\\ReviewsController', {id: repository.id}) }}">
                            {{- repository.displayName -}}

                            <small class="d-block text-secondary">
                                {{ projectsModel.revisionCount[repository.id]|format_number }} {{ 'revisions'|trans }}
                            </small>
                        </a>
                    {%- endfor -%}
                </div>
            {%- endfor -%}
        </div>
    {%- endif -%}

{%- endmacro -%}
{%- from _self import projectColumns -%}


{% block page_content %}
    <h1 class="mt-2">{{ 'projects'|trans }}</h1>

    <div style="display: grid; grid-template-columns: 70% 30%; grid-column-gap: 10px">
        <div>
            {{ projectColumns(projectsModel, projectsModel.favoriteRepositories) }}
            {{ projectColumns(projectsModel, projectsModel.regularRepositories) }}
        </div>
        {% include 'app/project/projects.timeline.html.twig' with {timelineViewModel: projectsModel.timeline} %}
    </div>

{% endblock %}
